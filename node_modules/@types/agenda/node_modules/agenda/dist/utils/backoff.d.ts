/**
 * Backoff strategy utilities for job retry logic
 */
/**
 * Context passed to backoff strategy functions
 */
export interface BackoffContext {
    /** Current attempt number (1-based, so first retry is attempt 1) */
    attempt: number;
    /** The error that caused the failure */
    error: Error;
    /** Job name */
    jobName: string;
    /** Job data */
    jobData: unknown;
}
/**
 * A backoff strategy is a function that returns the delay in milliseconds
 * before the next retry attempt, or `null` to stop retrying.
 */
export type BackoffStrategy = (context: BackoffContext) => number | null;
/**
 * Options for built-in backoff strategies
 */
export interface BackoffOptions {
    /** Initial delay in milliseconds (default: 1000) */
    delay?: number;
    /** Maximum delay in milliseconds (default: Infinity) */
    maxDelay?: number;
    /** Maximum number of retry attempts (default: 3) */
    maxRetries?: number;
    /** Add randomness to prevent thundering herd (default: 0, range: 0-1) */
    jitter?: number;
}
/**
 * Options specific to exponential backoff
 */
export interface ExponentialBackoffOptions extends BackoffOptions {
    /** Multiplier for each attempt (default: 2) */
    factor?: number;
}
/**
 * Options specific to linear backoff
 */
export interface LinearBackoffOptions extends BackoffOptions {
    /** Amount to increase delay by each attempt (default: same as delay) */
    increment?: number;
}
/**
 * Constant backoff - same delay between each retry
 *
 * @example
 * ```ts
 * agenda.define('myJob', handler, {
 *   backoff: constant({ delay: 5000, maxRetries: 5 })
 * });
 * // Retries at: 5s, 5s, 5s, 5s, 5s
 * ```
 */
export declare function constant(options?: BackoffOptions): BackoffStrategy;
/**
 * Linear backoff - delay increases by a fixed amount each retry
 *
 * @example
 * ```ts
 * agenda.define('myJob', handler, {
 *   backoff: linear({ delay: 1000, increment: 2000, maxRetries: 4 })
 * });
 * // Retries at: 1s, 3s, 5s, 7s
 * ```
 */
export declare function linear(options?: LinearBackoffOptions): BackoffStrategy;
/**
 * Exponential backoff - delay multiplies by a factor each retry
 *
 * @example
 * ```ts
 * agenda.define('myJob', handler, {
 *   backoff: exponential({ delay: 1000, factor: 2, maxRetries: 5 })
 * });
 * // Retries at: 1s, 2s, 4s, 8s, 16s
 *
 * // With jitter to prevent thundering herd:
 * agenda.define('myJob', handler, {
 *   backoff: exponential({ delay: 1000, factor: 2, maxRetries: 5, jitter: 0.2 })
 * });
 * ```
 */
export declare function exponential(options?: ExponentialBackoffOptions): BackoffStrategy;
/**
 * Combine multiple strategies - tries each in sequence until one returns non-null
 * Useful for implementing complex retry logic
 *
 * @example
 * ```ts
 * // Retry quickly at first, then back off
 * agenda.define('myJob', handler, {
 *   backoff: combine(
 *     // First 2 retries: immediate (100ms)
 *     (ctx) => ctx.attempt <= 2 ? 100 : null,
 *     // Then exponential backoff for 3 more attempts
 *     exponential({ delay: 1000, maxRetries: 3 })
 *   )
 * });
 * ```
 */
export declare function combine(...strategies: BackoffStrategy[]): BackoffStrategy;
/**
 * Conditional backoff - only retry if condition is met
 *
 * @example
 * ```ts
 * // Only retry on specific errors
 * agenda.define('myJob', handler, {
 *   backoff: when(
 *     (ctx) => ctx.error.message.includes('timeout'),
 *     exponential({ delay: 1000, maxRetries: 3 })
 *   )
 * });
 * ```
 */
export declare function when(condition: (context: BackoffContext) => boolean, strategy: BackoffStrategy): BackoffStrategy;
/**
 * Pre-configured backoff strategies for common use cases
 */
export declare const backoffStrategies: {
    /** Constant 1s delay, 3 retries */
    constant: typeof constant;
    /** Linear increase starting at 1s, 3 retries */
    linear: typeof linear;
    /** Exponential with factor 2, starting at 1s, 3 retries */
    exponential: typeof exponential;
    /** Combine multiple strategies */
    combine: typeof combine;
    /** Conditional retry */
    when: typeof when;
    /**
     * Aggressive retry - quick retries for transient failures
     * 100ms, 200ms, 400ms (3 retries in ~700ms total)
     */
    aggressive: () => BackoffStrategy;
    /**
     * Relaxed retry - gentle backoff for rate-limited APIs
     * 5s, 15s, 45s, 135s (4 retries over ~3 minutes)
     */
    relaxed: () => BackoffStrategy;
    /**
     * Standard retry - balanced approach
     * 1s, 2s, 4s, 8s, 16s (5 retries over ~31 seconds)
     */
    standard: () => BackoffStrategy;
};
