import { BaseNotificationChannel } from './BaseNotificationChannel.js';
/**
 * In-memory notification channel for testing and single-process scenarios.
 * Notifications are delivered synchronously within the same process.
 */
export class InMemoryNotificationChannel extends BaseNotificationChannel {
    constructor(config = {}) {
        super(config);
    }
    async connect() {
        this.clearReconnect();
        this.setState('connected');
    }
    async disconnect() {
        this.clearReconnect();
        this.handlers.clear();
        this.stateHandlers.clear();
        this.setState('disconnected');
    }
    async publish(notification) {
        if (this._state !== 'connected') {
            throw new Error('Cannot publish: channel not connected');
        }
        await this.notifyHandlers(notification);
    }
    async publishState(notification) {
        if (this._state !== 'connected') {
            throw new Error('Cannot publish state: channel not connected');
        }
        await this.notifyStateHandlers(notification);
    }
}
//# sourceMappingURL=InMemoryNotificationChannel.js.map