/**
 * Compute the state for a job based on its timestamps
 */
export function computeJobState(job, now = new Date()) {
    const { lockedAt, lastFinishedAt, failedAt, nextRunAt, repeatInterval } = job;
    // Running: currently locked and processing
    if (lockedAt) {
        return 'running';
    }
    // Failed: has failed and failure is more recent than completion
    if (failedAt && (!lastFinishedAt || failedAt > lastFinishedAt)) {
        return 'failed';
    }
    // Repeating: has repeat interval and hasn't failed
    if (repeatInterval) {
        return 'repeating';
    }
    // Scheduled: next run is in the future
    if (nextRunAt && nextRunAt > now) {
        return 'scheduled';
    }
    // Queued: next run is now or past (ready to run)
    if (nextRunAt && nextRunAt <= now) {
        return 'queued';
    }
    // Completed: has finished and either no failure or completion is more recent
    if (lastFinishedAt && (!failedAt || lastFinishedAt >= failedAt)) {
        return 'completed';
    }
    // Default to completed if nothing else matches
    return 'completed';
}
//# sourceMappingURL=JobQuery.js.map